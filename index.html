<html>
<head>
    <meta charset="utf-8"/>
    <script type="text/javascript" src="js/data.js"></script>
    <script type="text/javascript" src="js/index.js"></script>
    <script type="text/javascript" src="js/orbits.js"></script>
    <script type="text/javascript" src="js/factors.js"></script>
    <script type="text/javascript" src="js/colors.js"></script>
    <script type="text/javascript" src="js/table.js"></script>

    <script type="text/javascript" src="js/x3dom-full.js"></script>
    <link rel="stylesheet" type="text/html" href="js/x3dom.css"/>

    <script type="text/javascript" src="js/3d.js"></script>
    <script
            id="MathJax-script"
            type="text/javascript"
            async
            src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-MML-AM_CHTML">
    </script>
    <script>
            MathJax = {
              tex: {
                tags: 'ams'
              }
            };



    </script>
    <style>
            body {
                font-family: Arial, Helvetica, sans-serif;
                width: 80%;
                font-size: 80%;
                padding: 20pt;
            }

            .small {
                font: italic 40% sans-serif;
            }

            th {
                vertical-align: bottom;
            }

            .pagebreak {
                min-height: 1px;
                page-break-before: always;
            }

            .equation-list { list-style-type: none; }
            .equation-list li { padding: 6pt; }


            .place-values-table {
                font-size: 90%;
            }

            .places-values-spacer {
                border-bottom: dotted 1px;
            }

            th.places-left  {
                border-bottom: dashed 1px;
            }
            th.places-right  {
                border-bottom: dashed 1px;
            }

            th.tally-value  {
                border-bottom: dashed 1px;
                text-align: center;
                font-style: italic;
                font-weight: normal;
            }
            td.tally-value {
                text-align: center;
                font-weight: normal;
                font-style: italic;
                font-weight: bold;
                background: LemonChiffon;
            }

            .places-left {
                text-align: center;
                font-weight: normal;
            }
            .places-right {
                text-align: center;
                font-weight: normal;
            }

            .box-text {
                font-weight: bold;
            }

            table.raw-permutation  {
            }

            table.raw-permutations  {
                font-weight: bold;
                padding: 20px;
            }

            table.raw-permutation td {
                text-align: center;
                font-weight: bold;
                padding: 5px;
                margin: 10px;
            }

            table.raw-permutation tr:first-child td {
                border-bottom: dotted 1px;
            }

            table.raw-permutation td {
                border-left: dotted 1px;
                width: 20px;
            }

            table.raw-permutation td:first-child {
                border-left: 0px;
            }

            .fixed-point {
                color: red;
            }

            ol.raw-permutation li {
              #list-style: symbols(cyclic "&alpha;" "&beta;");
              list-style-type: lower-greek;
            }



            .minuend {
                color: blue;
            }

            .chain-details { font-size: 90%; border-top: solid 1px black; }
            .chain-details tr { vertical-align: top; }
            .chain-details tr:nth-child(even) { background: Ivory; }
            .chain-details tr:nth-child(odd) { background: WhiteSmoke; }
            .chain-details tr:last-child td { border-top: double 1px; }
            .chain-details td { text-align: center; padding-left: 25px; padding-right: 25px; }



    </style>
    <script>
            function drawBoxItems( bases = [ 3, 5 ] ) {

                const box = new Box( bases );
                const columns = box
                    .points
                    .map( p => [
                        p.idx[0] == p.idx[1] ? ' class="fixed-point"' : '',
                        p.idx[0],
                        p.idx[1] ] );

                const upRow = columns
                    .map( x => `<td${ x[0] }>${ x[1] }</td>` )
                    .join( "\n" );

                const downRow = columns
                    .map( x => `<td${ x[0] }>${ x[2] }</td>` )
                    .join( "\n" );

                return `<table class="raw-permutation"><tr>${ downRow }</tr><tr>${ upRow }</tr></table>`;
            }



    </script>
</head>
<body>
    <h1>Thinking inside the box</h1>

    <h2>Tally Ho!</h2>
    To tally a box means to systematically count the items (or points) inside.
    <br/>
    <br/>
    The process seems obvious:
    <ol>
        <li>assign an initial tally value of 0</li>
        <li>
            unpack each point
            <ol>
                <li>assign the current tally value to the current point</li>
                <li>increase the tally by 1</li>
            </ol>
        </li>
        <li>collect the final tally (increased by 1 after the final point)</li>
        <li>assert the final tally is equal to the volume of the box</li>
    </ol>
    At the end of the process,
    each point will have been assigned a unique tally value,
    an index value,
    from 0 up to one less than the volume of the box.
    <br/>
    <br/>

    <h2>Two dimensional boxes</h2>

    There are two ways to unpack the two-dimensional box <span class="box-text">5 x 3</span>;
    either counting 5 lots of 3, or as 3 lots of 5.
    <br/>
    <br/>
    Clearly, each way must tally to the same volume,
    but each way can assign different tally values to some points.
    <br/>
    <br/>
    This is seen by aligning some rows from the corresponding place values tables:
    <br/>
    <br/>
    <table class="place-values-table">
        <tr>
            <th class="places-left">fives</th>
            <th class="places-left">units</th>
            <th class="tally-value">(tally)</th>
            <th>&nbsp;</th>
            <th class="tally-value">(tally)</th>
            <th class="places-right">units</th>
            <th class="places-right">threes</th>
        </tr>
        <tr>
            <td class="places-left">0</td>
            <td class="places-left">0</td>
            <td class="tally-value">0</td>
            <td>=</td>
            <td class="tally-value">0</td>
            <td class="places-right">0</td>
            <td class="places-right">0</td>
        </tr>
        <tr>
            <td class="places-values-spacer" colspan="2"></td>
            <td colspan="3"></td>
            <td class="places-values-spacer" colspan="2"></td>
        </tr>
        <tr>
            <td class="places-left">0</td>
            <td class="places-left">1</td>
            <td class="tally-value">1</td>
            <td>&lt;</td>
            <td class="tally-value">3</td>
            <td class="places-right">0</td>
            <td class="places-right">1</td>
        </tr>
        <tr>
            <td class="places-left">1</td>
            <td class="places-left">0</td>
            <td class="tally-value">5</td>
            <td>&gt;</td>
            <td class="tally-value">1</td>
            <td class="places-right">1</td>
            <td class="places-right">0</td>
        </tr>
        <tr>
            <td class="places-values-spacer" colspan="2"></td>
            <td colspan="3"></td>
            <td class="places-values-spacer" colspan="2"></td>
        </tr>
        <tr>
            <td class="places-left">1</td>
            <td class="places-left">2</td>
            <td class="tally-value">7</td>
            <td>=</td>
            <td class="tally-value">7</td>
            <td class="places-right">1</td>
            <td class="places-right">2</td>
        </tr>
        <tr>
            <td class="places-values-spacer" colspan="2"></td>
            <td colspan="3"></td>
            <td class="places-values-spacer" colspan="2"></td>
        </tr>
        <tr>
            <td class="places-left">2</td>
            <td class="places-left">3</td>
            <td class="tally-value">13</td>
            <td>&gt;</td>
            <td class="tally-value">11</td>
            <td class="places-right">2</td>
            <td class="places-right">3</td>
        </tr>
        <tr>
            <td class="places-values-spacer" colspan="2"></td>
            <td colspan="3"></td>
            <td class="places-values-spacer" colspan="2"></td>
        </tr>
        <tr>
            <td class="places-left">2</td>
            <td class="places-left">4</td>
            <td class="tally-value">14</td>
            <td>=</td>
            <td class="tally-value">14</td>
            <td class="places-right">2</td>
            <td class="places-right">4</td>
        </tr>
    </table>
    <br/>
    <br/>
    The tally columns together implement a permutation of 15 points,
    which can be considered from two, mutually inverse, perspectives:
    <br/>
    <br/>
    <table class="raw-permutations">
        <tr>
            <td>Î±ðŸ …</td>
            <td>
                <script>document.write( drawBoxItems( [ 5, 3 ] ) );</script>
            </td>
        </tr>
    </table>
    <table class="raw-permutations">
        <tr>
            <td>Î±ðŸ ‡</td>
            <td>
                <script>document.write( drawBoxItems( [ 3, 5 ] ) );</script>
            </td>
        </tr>
    </table>
    <br/>
    <br/>

    <div style="page-break-before: always;">&nbsp;</div>

    This permutation of 15 points has 3 fixed points and 2 cycles (or orbits) each with 6 member points,
    where the inverse is the same fixed points and cycles in reverse order.
    <br/>
    <br/>
    <table class="chain-details summary sortable" data-sort-column="0">
        <tr>
            <th>Id</th>
            <th>Cycle</th>
            <th>Point Sum</th>
            <th>Id Sum</th>
            <th>E-Per<sup>2</sup></th>
            <th>I-Per</th>
        </tr>
        <tr>
            <th><code>(e)</code></th>
            <th><code>( 0 ) ( 7 ) ( 14 )</code></th>
            <th><code>(6,3)</code></th>
            <th><code>3 * 7</code></th>
            <th colspan="1"><code>0</code></th>
            <th colspan="1"><code>0</code></th>
        </tr>
        <tr>
            <td align="center">1</td>
            <td class="orbit">( 1 5 11 â†˜<br>13 9 3 â†–)</td>
            <td align="center">(12, 6)</td>
            <td align="center">3 * 14</td>
            <td align="center">8</td>
            <td align="center">12</td>
        </tr>
        <tr>
            <td align="center">2</td>
            <td class="orbit">( 2 10 8 â†˜<br>12 4 6 â†–)</td>
            <td align="center">(12, 6)</td>
            <td align="center">3 * 14</td>
            <td align="center">20</td>
            <td align="center">14</td>
        </tr>
        <tr>
            <td></td>
            <td colspan="1"></td>
            <td class="sum-total"><span class="sum-total">( 30, 15 )</span></td>
            <td class="sum-total"><span class="sum-total">15 * 7</span></td>
            <td class="sum-total "><span class="sum-total ">7 * 4</span></td>
            <td class="sum-total "><span class="sum-total ">13 * 2</span></td>
        </tr>
    </table>
    <br/>
    In this case, both orbits are self-conjugate.
    <br/>
    <br/>
    Two points are conjugate when:
    <ul>
        <li>they are opposite each other with respect to the centre of the box</li>
        <li>the sum of the index values equals one less than the box volume</li>
    </ul>
    Self-conjugate orbits are indicated in the table by splitting the orbit member sequence into two equal parts
    and laying the parts over each other so that each point lies over its conjugate.
    Therefore, a self-conjugate orbit cannot have an odd number of members.
    <br/>
    <br/>
    The fixed points and orbits can be visualized in a 2 dimensional grid:
    <ul>
        <li>The euclidean perimeter of each orbit is the distance travelled for a complete revolution - hence a
            velocity
        </li>
        <li>The square of the perimeter is therefore proportional to some quanta of energy,
            the inverse orbit having a corresponding negative relative value
        </li>
    </ul>
    <div>
        <x3d showStat="false" width="600" height="400">
            <scene>
                <transform translation="-1 -0.5 0" scale="1.9 1.9 1.9">
                    <inline url="x3d/box-5x3.euc.x3d"/>
                </transform>
            </scene>
        </x3d>
    </div>
    The fixed points and orbits can also be visualized in a radiance diagram:
    <ul>
        <li>The sum of the absolute value of the index jumps of each orbit is the index distance (perimeter) travelled
            for a complete revolution
        </li>
    </ul>
    <div>
        <x3d showStat="false" width="600" height="400">
            <scene>
                <transform scale="0.8 0.8 0.8">
                    <inline url="x3d/box-5x3.rad.x3d"/>
                </transform>
            </scene>
        </x3d>
    </div>

    <div style="page-break-before: always;">&nbsp;</div>

    <h3>Two more boxes</h3>
    The box <span class="box-text">3 x 7</span> has the following table and diagrams:
    <br/>
    <br/>

    <table class="chain-details summary sortable">
        <caption>Box: 3 x 7</caption>
        <tr>
            <th>Id</th>
            <th>Cycle</th>
            <th>Point Sum</th>
            <th>Id Sum</th>
            <th>E-Per<sup>2</sup></th>
            <th>I-Per</th>
        </tr>
        <tr>
            <th><code>e</code></th>
            <th><code>( 0 ) ( 10 ) ( 20 )</code</th>
            <th><code>(9,3)</code></th>
            <th><code>3 * 10</code></th>
            <th><code>0</code></th>
            <th><code>0</code></th>
        </tr>
        <tr>
            <td>1</td>
            <td>( 1 3 9 7 )<br>( 19 17 11 13 )</td>
            <td>(6, 2)<br>(18, 6)</td>
            <td>1 * 20<br>3 * 20</td>
            <td>12</td>
            <td>16</td>
        </tr>
        <tr>
            <td>3</td>
            <td>( 2 6 â†˜<br>18 14 â†–)</td>
            <td>(12, 4)</td>
            <td>2 * 20</td>
            <td>24</td>
            <td>16</td>
        </tr>
        <tr>
            <td>4</td>
            <td>( 4 12 â†˜<br>16 8 â†–)</td>
            <td>(12, 4)</td>
            <td>2 * 20</td>
            <td>12</td>
            <td>12</td>
        </tr>
        <tr>
            <td>5</td>
            <td>( 5 â†˜<br>15 â†–)</td>
            <td>(6, 2)</td>
            <td>1 * 20</td>
            <td>20</td>
            <td>10</td>
        </tr>
        <tr>
            <td colspan="2"></td>
            <td><span>( 63, 21 )</span></td>
            <td><span>21 * 10</span></td>
            <td><span>17 * 4</span></td>
            <td><span>27 * 2</span></td>
        </tr>
    </table>
    <br/>
    The first two orbits make a conjugate pair,
    whereas the remaining three are self-conjugate.
    <div>
        <x3d showStat="false" width="600" height="400">
            <scene>
                <transform translation="-1" scale="1.5 1.5 1.5">
                    <inline url="x3d/box-3x7.euc.x3d"/>
                </transform>
            </scene>
        </x3d>
    </div>

    <div>
        <x3d showStat="false" width="600" height="400">
            <scene>
                <transform scale="0.7 0.7 0.7">
                    <inline url="x3d/box-3x7.rad.x3d"/>
                </transform>
            </scene>
        </x3d>
    </div>
    <br/>
    <br/>
    <div style="page-break-before: always;">&nbsp;</div>

    The box <span class="box-text">7 x 5</span> has the following table and diagrams:
    <br/>
    <br/>
    <table class="chain-details summary sortable">
        <tr>
            <th>Id</th>
            <th>Cycle</th>
            <th>Point Sum</th>
            <th>Id Sum</th>
            <th>E-Per<sup>2</sup></th>
            <th>I-Per</th>
        </tr>
        <tr>
            <th><code>e</code></th>
            <th><code>( 0 ) ( 17 ) ( 34 )</code>
            </th>
            <th>
                <code>(6,9)</code>
            </th>
            <th>
                <code>3 * 17</code>
            </th>
            <th colspan="1">
                <code>0</code>
            </th>
            <th colspan="1">
                <code>0</code>
            </th>
        </tr>
        <tr>
            <td>1</td>
            <td>( 1 7 15 3 21 11 9 29 â†˜<br>33 27 19 31 13 23 25 5 â†–)</td>
            <td>(32, 48)</td>
            <td>8 * 34</td>
            <td>80</td>
            <td>80</td>
        </tr>
        <tr>
            <td>2</td>
            <td>( 2 14 30 6 8 22 18 24 â†˜<br>32 20 4 28 26 12 16 10 â†–)</td>
            <td>(32, 48)</td>
            <td>8 * 34</td>
            <td>92</td>
            <td>86</td>
        </tr>
        <tr>
            <td colspan="2">&nbsp;</td>
            <td>
                <span>( 70, 105 )</span>
            </td>
            <td>
                <span>35 * 17</span>
            </td>
            <td>
                <span>43 * 4</span>
            </td>
            <td>
                <span>83 * 2</span>
            </td>
        </tr>
    </table>


    <div>
        <x3d showStat="false" width="600" height="400">
            <scene>
                <transform translation="0 -1 0" scale="1.2 1.2 1.2">
                    <inline url="x3d/box-7x5.euc.x3d"/>
                </transform>
            </scene>
        </x3d>
    </div>

    <div>
        <x3d showStat="false" width="600" height="400">
            <scene>
                <transform scale="0.7 0.7 0.7">
                    <inline url="x3d/box-7x5.rad.x3d"/>
                </transform>
            </scene>
        </x3d>
    </div>

    <div style="page-break-before: always;">&nbsp;</div>

    <h2>Three dimensional boxes</h2>
    There are 6 ways to unpack the three-dimensional box <span class="box-text">7 x 5 x 3</span>
    corresponding with 6 permutations of the 3 bases.
    <br/>
    <br/>
    <table class="chain-details summary sortable">
        <tr><th>Label</th><th>Perm</th><th>Place Values</th></tr>
        <tr><td>Î±ðŸ …</td><td>[ 2, 1, 0 ]</td><td>[ 15, 3, 1 ]</td></tr>
        <tr><td>Î²ðŸ …</td><td>[ 0, 2, 1 ]</td><td>[ 1, 21, 7 ]</td></tr>
        <tr><td>Î³ðŸ …</td><td>[ 1, 0, 2 ]</td><td>[ 5, 1, 35 ]</td></tr>
        <tr><td>Î±ðŸ ‡</td><td>[ 0, 1, 2 ]</td><td>[ 1, 7, 35 ]</td></tr>
        <tr><td>Î²ðŸ ‡</td><td>[ 1, 2, 0 ]</td><td>[ 15, 1, 5 ]</td></tr>
        <tr><td>Î³ðŸ ‡</td><td>[ 2, 0, 1 ]</td><td>[ 5, 1, 35 ]</td></tr>
        <tr><td colspan="3"></td></tr>
    </table>
    <br/>
    <br/>
    The index produced by each way of unpacking can be compared with every other one (including itself)
    to create 36 permutations of 105 points (the box volume).
    <br/>
    <br/>
    Clearly, comparing an index with itself must produce an identity permutation.

</body>
</html>
