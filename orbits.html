<html>
<head>
    <meta charset="utf-8"/>
    <style>
        body {
            font-family: Arial, Helvetica, sans-serif;
            font-size: 80%;
            padding-left: 20pt;
            padding-right: 20pt;
        }

        .full-width {
            clear: both;
        }

        textarea.formulaPanel {
            width: 100%;
            font-size: 80%;
        }

        .symbolic-composition-control {
            border: dotted 1px;
            padding: 2px;
            background: LemonChiffon;
        }

        .caption {
            float: left;
            overflow: hidden;
            display: inline-block;
            text-align: left;
        }

        .toolbar {
            float: right;
            overflow: hidden;
            display: inline-block;
            text-align: right;
            font-size: 70%;
        }

        .summaryLeft {
            font-size: 70%;
            text-align: left;
            font-style: bold;
        }

        .summaryRight {
            font-size: 70%;
            text-align: right;
        }

        .orbit {}

        .plot_frame {
            width: 100%;
            height: 80%;
            resize: both;
            overflow: auto;
        }

        .difference {
            color: red;
        }

        .minuend {
            color: blue;
        }

        .small {
            font: italic 40% sans-serif;
        }

        table > caption {
            text-align: left;
            font-style: bold;
        }

        th {
            vertical-align: bottom;
        }

        .chain-details-legend {
            text-align: center;
            font-style: italic;
        }

        .grid-controls-container {
            width: 100%;
            text-align: right;
            font-size: 90%;
        }

        .grid-controls {
            display: inline;
        }
        .control {
            display: inline;
        }

        .resizable {
            resize: both;
            overflow: auto;
        }

        .legend {
            text-align: center;
            font-style: italic;
        }

        .selected { background: Pink; }

        th { padding-left: 2pt; padding-right: 2pt; }

        .sort-asc::after { content: " \2193"; font-face: bold; }
        .sort-desc::after { content: " \2191"; font-face: bold;  }

        td.orbit { vertical-align: middle; }

        td.sum-total { text-align: center; }
        span.sum-total { border-top: 1px solid;}

        td.product-total { text-align: center; }
        span.product-total { border-top: 2px dotted red;}

        .chain-details { width: 100%; font-size: 80%; border-top: solid 1px black }
        .chain-details tr { vertical-align: top; }
        .chain-details tr:nth-child(even) { background: Ivory; }
        .chain-details tr:nth-child(odd) { background: WhiteSmoke; }

        .pagebreak {
            min-height: 1px;
            page-break-before: always;
        }

        .equation {
            background: WhiteSmoke;
            font-weight: bold;
        }
        .monomial { background: Ivory; }

        .equation-list { list-style-type: none; }
        .equation-list li { padding: 6pt; }

        input[type=number] {
            width: 40pt;
            text-align: right;
        }
        input.colourField {
            font-size: 80%;
            width: 30pt;
        }
        textarea.colourField {
            font-size: 80%;
            width: 200pt;
        }
        input[type=button] {
            font-size: 80%;
        }

        input[type=checkbox] {
            font-style: italic;
        }
        input[type=range] {
            width: 100%;
        }
        textarea.index-products {
            width: 100%;
            height: 100%;
        }
    </style>

    <script type="text/javascript" src="js/x3dom-full.js"></script>
    <link rel="stylesheet" type="text/html" href="js/x3dom.css"/>



    <script type="text/javascript" src="js/toggles.js"></script>

    <script type="text/javascript" src="js/midi.js"></script>
    <script type="text/javascript" src="js/data.js"></script>

    <script type="text/javascript" src="js/bases.js"></script>
    <script type="text/javascript" src="js/orbits.js"></script>
    <script type="text/javascript" src="js/index.js"></script>
    <script type="text/javascript" src="js/jbnd.js"></script>


    <script type="text/javascript" src="js/factors.js"></script>
    <script type="text/javascript" src="js/colors.js"></script>
    <script type="text/javascript" src="js/table.js"></script>
    <script type="text/javascript" src="js/3d.js"></script>


    <script type="text/javascript" src="js/pageOrbits.js"></script>

    <script type="text/javascript" src="js/expression.js"></script>

    <script type="text/javascript" src="js/compositions.js"></script>

</head>
<body id="testContainer001" onload="initPage()">
    <div>
        <div id="caption" class="caption">
            <a onclick="reopenWithArgs()"  title="click to reopen with current values in url"><b>Box: </b></a>

            <label title="change the order of the box"><input type="number" min="1" id="bases" value="3" onchange="initPage( false )"/></label>

            <a onclick="reopenWithReversedArgs()" title="reopen with reversed base values in url">&#8597;</a>
            <a onclick="reopenWithLeftRotatedArgs()" title="reopen with left-rotated base values in url">&#8592;</a>
            <a onclick="reopenWithRightRotatedArgs()" title="reopen with right-rotated base values in url">&#8594;</a>

            <span id="baseValues">
                <input type="number" min="1" id="b0" value="7"/>x
                <input type="number" min="1" id="b1" value="5"/>x
                <input type="number" min="1" id="b2" value="3"/>x
                <input type="number" min="1" id="b3" value="2"/>
            </span> |

            <input type="number" id="basesVolume" title="the volume of the box" disabled="disabled"/> |

            <label title="change the selected box action"> action-id: <input type="number" min="0" id="actionIndex" value="1" onchange="selectBoxAction()"/></label>

            <span id="captionTex" class="summaryLeft"></span>
            <br/>
        </div>

        <div id="toolbar" class="toolbar">
            <label title="toggle actions table">actions<input type="checkbox" id="actionsToggle" onchange="showHideAll(['actionControls','actionsTable'], this )"/></label> |
            <label title="toggle cycles table">cycles<input type="checkbox" id="cyclesToggle" onchange="showHideAll(['cyclesControls','sample_cs_b_10_m_2_table'], this)" title="display a table of identities and orbits"/></label> |
            <label title="toggle orbits chart">chart<input type="checkbox" id="chartToggle" onchange="showHideAll(['chartControls','sample_cs_b_10_m_2_plot','sample_cs_b_10_m_2_plot_legend','sample_cs_b_10_m_2_riffler'], this)"/></label> |
            <label title="toggle more options">more<input type="checkbox" id="moreToggle" onchange="showHideAll( ['more-options'], this )"/></label>

            <div id="more-options" style="display: none">
                <hr/>
                <label title="globalise all ids">globalise <input type="checkbox" id="globaliseToggle" onchange="updatePage()"/></label> |
                <label title="display global ids">global ids <input type="checkbox" id="globalIdsToggle" onchange="selectBoxAction()"/></label> |
                <label title="rollup orbits with their conjugates">conj.<input type="checkbox" id="conjToggle" onchange="updateJson()"/></label> |
                <label title="display coordinates instead of ids">coords<input type="checkbox" id="coordsToggle" onchange="updateJson()"/></label> |
                <label title="minimal columns">min-cols <input type="checkbox" id="minColsToggle" onchange="updatePage()"/></label> |
                <label title="colours">colours<input type="checkbox" id="coloursToggle" onchange="showHideAll( ['colours'], this )"/></label>

                <div id="colours" style="display: none">
                    <hr/>
                    <script>
                        const vId = id => Number( document.getElementById(id).value );
                        function getColorConfiguration() {
                            return [
                                [ vId("colour-red"), vId("colour-green"), vId("colour-blue") ],
                                vId("colour-actionIndex"),
                                vId("colour-orbitIndex"),
                                vId("colour-minPixel"),
                                vId("colour-maxPixel") ];
                        }
                        function applyColorBasePlane() {
                            const [ bases, orbitIndex, minPixel, maxPixel ] = getColorConfiguration();
                            distributeMessage( "sample_cs_b_10_m_2", { colors: [ bases, orbitIndex, minPixel, maxPixel ] } );
                        }
                        function masterColorBasePlane() {
                            const [ bases, orbitIndex, minPixel, maxPixel ] = getColorConfiguration();
                            initialiseBases( bases );
                            selectBoxAction();
                            distributeMessages( 'sample_cs_b_10_m_2', [ { 'basePlaneKey': basePlane.key, 'multi': isToggle('multi'), 'sender': 'colourBasePlane.' + orbitIndex } ] );
                        }
                    </script>
                    rgb
                    <input type="number" min="1" id="colour-red" value="4" class="colourField"/>
                    <input type="number" min="1" id="colour-green" value="4" class="colourField"/>
                    <input type="number" min="1" id="colour-blue" value="6" class="colourField"/> |
                    plane <input type="number" min="1" id="colour-actionIndex" value="1" class="colourField"/> |
                    orbit <input type="number" min="1" id="colour-orbitIndex" value="1" class="colourField"/> |
                    <a href="javascript:masterColorBasePlane()">master</a> |
                    min-pixel <input type="number" min="0" max="255" id="colour-minPixel" value="50" class="colourField"/> |
                    max-pixel <input type="number" min="0" max="255" id="colour-maxPixel" value="200" class="colourField"/> |
                    <a href="javascript:applyColorBasePlane()">apply</a>
                </div>
            </div>
            <div style="display: none" class="midi">
                <hr/>
                <textarea id="orbit-system-data-text-area" style="width: 100%; height: 40%;"></textarea>
            </div>
        </div>
    </div>

    <div class="full-width">
        <div id="actionControls" class="toolbar" style="display: none">
            <hr/>
            layers: <span id="boxLayerSelectors">
                <input id="box-layer.e" type="checkbox" class="box-layer-control" value="0" checked="checked"/>
                <input id="box-layer.2" type="checkbox" class="box-layer-control" value="2" checked="checked"/>
                <input id="box-layer.3" type="checkbox" class="box-layer-control" value="3" checked="checked"/>
                <input id="box-layer.4" type="checkbox" class="box-layer-control" value="4" checked="checked"/>
            </span>

            <label title="generate inverses">inverses<input type="checkbox" id="inversesToggle" onchange="updatePage()"/></label> |
            <label title="generate harmonics">harmonics<input type="checkbox" id="harmonicsToggle" onchange="updatePage()"/></label> |
            <label title="generate degenerates">degenerates<input type="checkbox" id="degeneratesToggle" onchange="updatePage()"/></label> |
            <label title="generate radiance">radiance<input type="checkbox" id="radianceToggle" onchange="updatePage()"/></label> |
            <label title="display filter controls">filter<input type="checkbox" id="monomialFilterToggle" onchange="showHideAll( ['monomialFilterControls'], this )"/></label> |
            <label title="display compose controls">composer<input type="checkbox" id="indexComposerToggle" onchange="showHideAll( ['indexComposer'], this )"/></label> |
            <label title="auto compose">auto compose<input type="checkbox" id="autoFormulaToggle" onchange="updatePage()"/></label>
        </div>

        <div id="monomialFilterControls" style="display: none" class="summaryLeft">
            <label title="Filter actions by monomial">
                Monomial: <span id="monomialFilterDisplay"><font color="red"><i>(no monomial selected)</i></font></span>
                <script>
                    function disableCheckBoxIfNoFilterElseUpdatePage( control ) {
                        const filterText = document.getElementById( "monomialFilter" ).value;
                        if ( filterText ) {
                            updatePage();
                        } else {
                            control.checked = false;
                        }
                    }
                </script>
                <input type="checkbox" id="monomialFilterEnabled" onchange="disableCheckBoxIfNoFilterElseUpdatePage( this )" value=""/>enable
            </label>
            <input type="text" id="monomialFilter" style="display: none"/>
        </div>

        <div id="indexComposer" style="display: none">
            <label><input type="button" onclick="processFormula()" value="compose"/></label>
            <span id="compositionSelectors"  class="summaryLeft"></span>
            <form name="compositionFormulas"><textarea id="compositionFormulas" class="formulaPanel" rows="3">#3d-odd-full;
a_0^-1; a_1^-1; a_2^-1;
e * a_0; e * a_1; e * a_2;

a_1 * a_0; ia_0 * ia_1;
a_1 * a_2; ia_2 * ia_1;
a_0 * a_1;  ia_1 * ia_0;
a_2 * a_1; ia_1 * ia_2;
a_0 * ia_2; a_2 * ia_0;
ia_0 * a_2; ia_2 * a_0;
a_0 * a_1 * a_2; ia_2 * a_0 * a_1; a_1 * a_2 * ia_0;
a_2 * ia_0 * ia_1; ia_1 * ia_2 * a_0; ia_0 * ia_1 * ia_2; </textarea></form>
            <span id="summaryEditorResult"></span>
            <div id="summaryEditorErrorMessage" class="difference"></div>
        </div>

        <div id="actionsTable" style="display: none"></div>
    </div>

    <div class="full-width">
        <div id="cyclesControls" class="toolbar" style="display: none">
            <hr/>
            <label title="show product table">products<input type="checkbox" id="productsToggle" onchange="showHideAll(['productsControls','productsTable'], this ); selectBoxAction();"/></label> |
            <label title="allow multi selection of orbits">multi<input type="checkbox" id="multiToggle"/></label> |
            <label title="display jump patterns">jumps<input type="checkbox" id="jumpsToggle" onchange="updateJson()"/></label>
        </div>
        <div id="sample_cs_b_10_m_2_table" style="display: none"></div>
    </div>

    <div class="full-width">
        <div id="productsControls" class="toolbar" style="display: none">
            <hr/>
            <label title="sort columns and rows by orbits">by orbit<input type="checkbox" id="productByOrbitsToggle" onchange="selectBoxAction()"/></label> |
            <label title="use the identity when convolution commutes">commute identity<input type="checkbox" id="productCommuteIdentityToggle" onchange="selectBoxAction()"/></label> |
            <label title="blank identity results">blank identity<input type="checkbox" id="productBlankIdentityToggle" onchange="selectBoxAction()"/></label>
        </div>

        <div id="productsTable" style="display: none">
            Products:
            <div id="products"></div>
        </div>
    </div>

    <div class="full-width">
        <div id="chartControls" class="toolbar" style="display: none">
            <hr/>
            <label title="only if there are three bases, display a 3d projection">3d<input type="checkbox" id="chart3dToggle" onchange="updateJson()"/></label> |
            <label title="scale 3d to a square">square<input type="checkbox" id="scale3dToggle" onchange="updateJson()"/></label> |
            <label title="show the box grid structure">grid<input type="checkbox" id="gridToggle" onchange="distributeMessage( 'sample_cs_b_10_m_2', { toggleGrid: 1 } )"/></label> |
            <label title="show orbit centres">centres<input type="checkbox" id="centresToggle" onchange="distributeMessage( 'sample_cs_b_10_m_2', { toggleCentres: 1 } )" /></label> |
            <label title="show the identity plane">plane<input type="checkbox" id="planeToggle" onchange="distributeMessage( 'sample_cs_b_10_m_2', { togglePlane: 1 } )"/></label> |
            <label title="show orbit lines">lines<input type="checkbox" id="linesToggle" onchange="distributeMessage( 'sample_cs_b_10_m_2', { toggleLines: 1 } )"/></label>
            <input type="button" onclick="screenshot( 'sample_cs_b_10_m_2' )" value="snap"/>
        </div>

        <div id="sample_cs_b_10_m_2_plot" style="display: none"></div>

        <div id="sample_cs_b_10_m_2_plot_legend" style="display: none" class='legend'>
            [ a, r, u | e, f, l, w, &lt;space&gt; ]
            see: <a href="https://doc.x3dom.org/tutorials/animationInteraction/navigation/index.html" target="_new">x3dom navigation tutorial</a>
        </div>

        <div style="width: 100%">
            <input
                    type="range"
                    min="0"
                    max="1"
                    id="sample_cs_b_10_m_2_riffler"
                    oninput="distributeMessages( 'sample_cs_b_10_m_2', [ { 'basePlaneKey': basePlane.key, 'multi': false, 'sender': ( this.id + '.' + this.value ) } ] )"
                    style="display: none" />
        </div>
    </div>

</body>
</html>
